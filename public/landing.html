<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="page-title">Cesantoni Premium</title>
    <meta name="description" id="meta-description" content="Descubre pisos premium de la m√°s alta calidad.">
    <meta property="og:title" id="og-title" content="Cesantoni Premium">
    <meta property="og:image" id="og-image" content="">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,300;0,400;0,500;0,600;1,300;1,400&family=Montserrat:wght@300;400;500;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --gold: #C9A962;
            --gold-light: #D4BC7E;
            --gold-dark: #A68B4B;
            --black: #0A0A0A;
            --charcoal: #1A1A1A;
            --gray-dark: #2D2D2D;
            --gray: #6B6B6B;
            --gray-light: #9A9A9A;
            --white: #FAFAFA;
            --cream: #F5F3EF;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        html { scroll-behavior: smooth; overflow-x: hidden; }
        body { overflow-x: hidden; }

        body {
            font-family: 'Montserrat', sans-serif;
            background: var(--black);
            color: var(--white);
            line-height: 1.6;
            overflow-x: hidden;
        }

        h1, h2, h3 {
            font-family: 'Cormorant Garamond', serif;
            font-weight: 300;
            letter-spacing: 0.02em;
        }

        /* Header */
        .header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 100;
            padding: 20px 40px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: linear-gradient(180deg, rgba(10,10,10,0.95) 0%, rgba(10,10,10,0) 100%);
            transition: all 0.4s ease;
        }

        .header.scrolled {
            background: rgba(10,10,10,0.98);
            backdrop-filter: blur(20px);
        }

        .logo {
            font-family: 'Cormorant Garamond', serif;
            font-size: 1.8rem;
            font-weight: 400;
            letter-spacing: 0.15em;
            color: var(--gold);
            text-decoration: none;
        }

        .logo span { font-weight: 300; color: var(--white); }

        .logo-link { display: flex; align-items: center; }
        .logo-img { height: 45px; width: auto; }

        .header-badge {
            font-size: 0.65rem;
            letter-spacing: 0.25em;
            text-transform: uppercase;
            color: var(--gray-light);
            border: 1px solid var(--gray-dark);
            padding: 8px 16px;
        }

        /* Video Hero */
        .video-hero {
            height: 100vh;
            min-height: 600px;
            position: relative;
            display: flex;
            align-items: flex-end;
            overflow: hidden;
            background: var(--charcoal);
        }

        .video-hero video {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .video-hero-overlay {
            position: absolute;
            inset: 0;
            background: linear-gradient(0deg, rgba(10,10,10,1) 0%, rgba(10,10,10,0.4) 40%, rgba(10,10,10,0.1) 70%, rgba(10,10,10,0.3) 100%);
        }

        .video-hero-content {
            position: relative;
            z-index: 2;
            padding: 0 60px 80px;
            width: 100%;
            max-width: 1400px;
            margin: 0 auto;
        }

        .hero-tag {
            display: inline-block;
            font-size: 0.7rem;
            letter-spacing: 0.3em;
            text-transform: uppercase;
            color: var(--gold);
            margin-bottom: 20px;
            padding: 10px 20px;
            border: 1px solid var(--gold);
            animation: fadeInUp 1s ease 0.3s backwards;
        }

        .hero-title {
            font-size: clamp(3rem, 10vw, 8rem);
            font-weight: 300;
            line-height: 1;
            margin-bottom: 20px;
            animation: fadeInUp 1s ease 0.5s backwards;
        }

        .hero-title em { font-style: italic; color: var(--gold); }

        .hero-subtitle {
            font-size: 1.1rem;
            font-weight: 300;
            color: var(--gray-light);
            max-width: 550px;
            line-height: 1.8;
            animation: fadeInUp 1s ease 0.7s backwards;
        }

        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(40px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .scroll-indicator {
            position: absolute;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
            animation: fadeInUp 1s ease 1s backwards;
            z-index: 2;
        }

        .scroll-indicator span {
            font-size: 0.65rem;
            letter-spacing: 0.2em;
            text-transform: uppercase;
            color: var(--gray);
        }

        .scroll-line {
            width: 1px;
            height: 60px;
            background: linear-gradient(180deg, var(--gold) 0%, transparent 100%);
            animation: scrollPulse 2s ease infinite;
        }

        @keyframes scrollPulse {
            0%, 100% { opacity: 0.3; }
            50% { opacity: 1; }
        }

        /* Sections */
        section { padding: 100px 40px; }
        .section-container { max-width: 1200px; margin: 0 auto; }

        .section-label {
            font-size: 0.65rem;
            letter-spacing: 0.3em;
            text-transform: uppercase;
            color: var(--gold);
            margin-bottom: 15px;
            display: block;
        }

        .section-title {
            font-size: clamp(2rem, 4vw, 3.5rem);
            margin-bottom: 40px;
            line-height: 1.2;
        }

        /* Gallery */
        .gallery { background: var(--charcoal); padding: 80px 40px; }

        .gallery-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            max-width: 1400px;
            margin: 0 auto;
        }

        .gallery-item {
            aspect-ratio: 1;
            overflow: hidden;
            position: relative;
            cursor: pointer;
        }

        .gallery-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.6s ease;
        }

        .gallery-item:hover img { transform: scale(1.1); }

        .gallery-item::after {
            content: '';
            position: absolute;
            inset: 0;
            border: 1px solid transparent;
            transition: border-color 0.3s ease;
        }

        .gallery-item:hover::after { border-color: var(--gold); }

        /* Product Info */
        .product-info { background: var(--black); }

        .product-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 80px;
            align-items: center;
        }

        .product-image {
            position: relative;
            overflow: hidden;
            aspect-ratio: 1;
        }

        .product-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .product-image::after {
            content: '';
            position: absolute;
            inset: 0;
            border: 1px solid var(--gold);
            transform: translate(15px, 15px);
            pointer-events: none;
        }

        .product-details h2 {
            font-size: 3rem;
            margin-bottom: 15px;
            color: var(--cream);
        }

        .product-format {
            font-size: 1.2rem;
            color: var(--gold);
            margin-bottom: 25px;
            letter-spacing: 0.1em;
        }

        .product-description {
            font-size: 1rem;
            color: var(--gray-light);
            line-height: 1.9;
            margin-bottom: 40px;
        }

        .product-specs-mini {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }

        .spec-mini {
            padding: 20px;
            background: var(--gray-dark);
            border-left: 3px solid var(--gold);
        }

        .spec-mini-value {
            font-family: 'Cormorant Garamond', serif;
            font-size: 1.4rem;
            color: var(--gold);
            margin-bottom: 5px;
        }

        .spec-mini-label {
            font-size: 0.7rem;
            letter-spacing: 0.15em;
            text-transform: uppercase;
            color: var(--gray);
        }

        /* Benefits */
        .benefits { background: linear-gradient(180deg, var(--black) 0%, var(--charcoal) 100%); }

        .benefits-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 30px;
            margin-top: 50px;
        }

        .benefit-card {
            padding: 40px 30px;
            background: var(--gray-dark);
            position: relative;
            overflow: hidden;
            transition: transform 0.4s ease;
        }

        .benefit-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 3px;
            background: var(--gold);
            transform: scaleX(0);
            transform-origin: left;
            transition: transform 0.4s ease;
        }

        .benefit-card:hover::before { transform: scaleX(1); }
        .benefit-card:hover { transform: translateY(-8px); }

        .benefit-icon { font-size: 2rem; margin-bottom: 20px; color: var(--gold); }
        .benefit-title { font-size: 1.3rem; margin-bottom: 12px; color: var(--cream); }
        .benefit-text { font-size: 0.9rem; color: var(--gray-light); line-height: 1.7; }

        /* Specs */
        .specs { background: var(--cream); color: var(--black); }
        .specs .section-label { color: var(--gold-dark); }
        .specs .section-title { color: var(--black); }

        .specs-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            margin-top: 40px;
        }

        .spec-item {
            padding: 25px;
            background: var(--white);
            border: 1px solid rgba(0,0,0,0.08);
            text-align: center;
            transition: all 0.3s ease;
        }

        .spec-item:hover {
            border-color: var(--gold);
            box-shadow: 0 10px 40px rgba(0,0,0,0.08);
        }

        .spec-value {
            font-family: 'Cormorant Garamond', serif;
            font-size: 1.6rem;
            font-weight: 500;
            color: var(--gold-dark);
            margin-bottom: 6px;
        }

        .spec-label {
            font-size: 0.7rem;
            letter-spacing: 0.15em;
            text-transform: uppercase;
            color: var(--gray);
        }

        /* Related Products */
        .related { background: var(--charcoal); }

        .related-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 25px;
            margin-top: 50px;
        }

        .related-item {
            background: var(--gray-dark);
            overflow: hidden;
            cursor: pointer;
            transition: transform 0.3s ease;
        }

        .related-item:hover { transform: translateY(-5px); }

        .related-item-image {
            aspect-ratio: 1;
            overflow: hidden;
        }

        .related-item-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.4s ease;
        }

        .related-item:hover .related-item-image img { transform: scale(1.08); }

        .related-item-info {
            padding: 20px;
        }

        .related-item-name {
            font-family: 'Cormorant Garamond', serif;
            font-size: 1.3rem;
            color: var(--cream);
            margin-bottom: 5px;
        }

        .related-item-category {
            font-size: 0.7rem;
            letter-spacing: 0.15em;
            text-transform: uppercase;
            color: var(--gold);
        }

        /* Store */
        .store { background: var(--black); }

        .store-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 60px;
            align-items: center;
        }

        .store-info h3 {
            font-size: 2.2rem;
            margin-bottom: 30px;
            color: var(--cream);
        }

        .store-detail {
            display: flex;
            align-items: flex-start;
            gap: 15px;
            margin-bottom: 20px;
        }

        .store-detail-icon {
            width: 22px;
            height: 22px;
            color: var(--gold);
            flex-shrink: 0;
            margin-top: 2px;
        }

        .store-detail-text {
            font-size: 0.95rem;
            color: var(--gray-light);
            line-height: 1.6;
        }

        .store-detail-text strong {
            display: block;
            color: var(--white);
            margin-bottom: 4px;
        }

        .promo-banner {
            background: linear-gradient(135deg, var(--gold-dark) 0%, var(--gold) 100%);
            padding: 20px 25px;
            margin-top: 30px;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .promo-banner-icon { font-size: 1.8rem; }
        .promo-banner-text { color: var(--black); }
        .promo-banner-text strong { display: block; font-size: 1rem; margin-bottom: 3px; }
        .promo-banner-text span { font-size: 0.85rem; opacity: 0.8; }

        .store-map {
            height: 350px;
            background: var(--gray-dark);
            overflow: hidden;
        }

        .store-map iframe {
            width: 100%;
            height: 100%;
            border: none;
            filter: grayscale(100%) contrast(1.1);
        }

        /* WhatsApp CTA */
        .whatsapp-cta {
            position: fixed;
            bottom: 25px;
            right: 25px;
            z-index: 99;
            display: flex;
            align-items: center;
            gap: 12px;
            background: #25D366;
            color: white;
            padding: 16px 28px;
            text-decoration: none;
            font-weight: 500;
            font-size: 0.9rem;
            box-shadow: 0 10px 40px rgba(37,211,102,0.4);
            transition: all 0.3s ease;
        }

        .whatsapp-cta:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 50px rgba(37,211,102,0.5);
        }

        .whatsapp-cta svg { width: 26px; height: 26px; }

        /* Footer */
        footer {
            background: var(--black);
            padding: 50px 40px 25px;
            text-align: center;
            border-top: 1px solid var(--gray-dark);
        }

        footer .logo-link { display: inline-block; margin-bottom: 15px; }
        footer .footer-logo { height: 50px; width: auto; }
        footer p { font-size: 0.75rem; color: var(--gray); letter-spacing: 0.1em; }

        /* Loading */
        .loading {
            position: fixed;
            inset: 0;
            background: var(--black);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            transition: opacity 0.5s ease;
        }

        .loading.hide { opacity: 0; pointer-events: none; }

        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 2px solid var(--gray-dark);
            border-top-color: var(--gold);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin { to { transform: rotate(360deg); } }

        /* Error */
        .error-state {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 40px;
        }

        .error-state h1 {
            font-size: 2.5rem;
            margin-bottom: 15px;
            color: var(--gold);
        }

        .error-state p { color: var(--gray-light); font-size: 1.1rem; }

        /* Lightbox */
        .lightbox {
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.95);
            z-index: 1000;
            display: none;
            align-items: center;
            justify-content: center;
            padding: 40px;
        }

        .lightbox.active { display: flex; }

        .lightbox img {
            max-width: 90%;
            max-height: 90%;
            object-fit: contain;
        }

        .lightbox-close {
            position: absolute;
            top: 30px;
            right: 30px;
            width: 50px;
            height: 50px;
            border: 1px solid var(--gray);
            background: none;
            color: var(--white);
            font-size: 1.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .lightbox-close:hover { border-color: var(--gold); color: var(--gold); }

        .lightbox-nav {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            width: 50px;
            height: 50px;
            border: 1px solid var(--gray);
            background: none;
            color: var(--white);
            font-size: 1.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .lightbox-nav:hover { border-color: var(--gold); color: var(--gold); }
        .lightbox-prev { left: 30px; }
        .lightbox-next { right: 30px; }

        /* Responsive */
        @media (max-width: 1024px) {
            .product-grid, .store-grid { grid-template-columns: 1fr; gap: 50px; }
            .benefits-grid { grid-template-columns: repeat(2, 1fr); }
            .specs-grid { grid-template-columns: repeat(2, 1fr); }
            .related-grid { grid-template-columns: repeat(2, 1fr); }
        }

        @media (max-width: 768px) {
            section { padding: 70px 25px; overflow-x: hidden; }
            .header { padding: 15px 25px; }
            .video-hero-content { padding: 0 25px 60px; }
            .benefits-grid { grid-template-columns: 1fr; }
            .specs { overflow: hidden; }
            .specs-grid { grid-template-columns: repeat(2, 1fr); gap: 10px; }
            .spec-item { padding: 20px 15px; }
            .spec-value { font-size: 1.2rem; white-space: nowrap; }
            .spec-label { font-size: 0.6rem; }
            .related-grid { grid-template-columns: 1fr 1fr; }
            .product-specs-mini { grid-template-columns: 1fr; }
            .whatsapp-cta { right: 15px; bottom: 15px; padding: 14px 20px; }
            .gallery-grid { grid-template-columns: 1fr 1fr; }
        }

        /* Chat IA */
        .chat-container { position: fixed; bottom: 25px; left: 25px; z-index: 99; }
        .chat-fab {
            width: 56px; height: 56px; border-radius: 50%;
            background: var(--gold); border: none; color: var(--black);
            cursor: pointer; display: flex; align-items: center; justify-content: center;
            box-shadow: 0 4px 20px rgba(201,169,98,0.4);
            transition: all 0.3s ease;
        }
        .chat-fab:hover { transform: scale(1.1); box-shadow: 0 6px 30px rgba(201,169,98,0.5); }
        .chat-window {
            display: none; position: absolute; bottom: 70px; left: 0;
            width: 340px; max-height: 460px; background: var(--charcoal);
            border: 1px solid var(--gray-dark); flex-direction: column;
            box-shadow: 0 10px 40px rgba(0,0,0,0.5);
        }
        .chat-window.open { display: flex; }
        .chat-header {
            display: flex; justify-content: space-between; align-items: center;
            padding: 14px 18px; background: var(--gold); color: var(--black);
        }
        .chat-header-title { font-weight: 600; font-size: 0.85rem; letter-spacing: 0.05em; }
        .chat-close {
            background: none; border: none; color: var(--black);
            font-size: 1.1rem; cursor: pointer; padding: 0; line-height: 1;
        }
        .chat-messages {
            flex: 1; overflow-y: auto; padding: 16px;
            display: flex; flex-direction: column; gap: 10px;
            max-height: 280px; min-height: 120px;
        }
        .chat-msg {
            padding: 10px 14px; font-size: 0.85rem; line-height: 1.5;
            max-width: 85%; word-wrap: break-word;
        }
        .chat-msg.bot {
            background: var(--gray-dark); color: var(--gray-light);
            align-self: flex-start; border-left: 3px solid var(--gold);
        }
        .chat-msg.user {
            background: var(--gold-dark); color: var(--black);
            align-self: flex-end;
        }
        .chat-msg.typing { opacity: 0.6; font-style: italic; }
        .chat-suggestions {
            display: flex; gap: 6px; padding: 8px 16px; flex-wrap: wrap;
        }
        .chat-suggestions button {
            background: var(--gray-dark); border: 1px solid var(--gray);
            color: var(--gray-light); padding: 5px 10px; font-size: 0.7rem;
            cursor: pointer; transition: all 0.2s ease;
        }
        .chat-suggestions button:hover { border-color: var(--gold); color: var(--gold); }
        .chat-input-row {
            display: flex; border-top: 1px solid var(--gray-dark);
        }
        .chat-input-row input {
            flex: 1; background: var(--black); border: none; color: var(--white);
            padding: 12px 16px; font-size: 0.85rem; outline: none;
            font-family: 'Montserrat', sans-serif;
        }
        .chat-input-row input::placeholder { color: var(--gray); }
        .chat-send {
            background: var(--gold); border: none; color: var(--black);
            padding: 12px 16px; cursor: pointer; font-size: 1rem;
            transition: background 0.2s;
        }
        .chat-send:hover { background: var(--gold-light); }

        @media (max-width: 768px) {
            .chat-container { left: 15px; bottom: 15px; }
            .chat-window { width: calc(100vw - 30px); left: 0; }
            .chat-fab { width: 48px; height: 48px; }
        }

        /* Hide sections without data */
        .hidden { display: none !important; }
    </style>
</head>
<body>
    <!-- Loading -->
    <div class="loading" id="loading">
        <div class="loading-spinner"></div>
    </div>

    <!-- Header -->
    <header class="header" id="header">
        <a href="/" class="logo-link">
            <img src="/images/logo-cesantoni.png" alt="Cesantoni" class="logo-img">
        </a>
        <div class="header-badge" id="header-badge">Coleccion Exclusiva</div>
    </header>

    <!-- Main Content (hidden until loaded) -->
    <main id="main-content" style="display: none;">

        <!-- Video Hero -->
        <section class="video-hero" id="video-hero">
            <video id="hero-video" autoplay muted loop playsinline></video>
            <div class="video-hero-overlay"></div>
            <div class="video-hero-content">
                <span class="hero-tag" id="hero-tag">Piso Premium</span>
                <h1 class="hero-title" id="hero-title">Producto</h1>
                <p class="hero-subtitle" id="hero-subtitle">Descripcion del producto</p>
            </div>
            <div class="scroll-indicator">
                <span>Descubre</span>
                <div class="scroll-line"></div>
            </div>
        </section>

        <!-- Gallery -->
        <section class="gallery" id="gallery-section">
            <div class="gallery-grid" id="gallery-grid"></div>
        </section>

        <!-- Product Info -->
        <section class="product-info">
            <div class="section-container">
                <div class="product-grid">
                    <div class="product-image">
                        <img id="product-main-image" src="" alt="">
                    </div>
                    <div class="product-details">
                        <span class="section-label" id="product-type">Porcelanico Premium</span>
                        <h2 id="product-name">Producto</h2>
                        <div class="product-format" id="product-format">Formato</div>
                        <p class="product-description" id="product-description">Descripcion</p>
                        <div class="product-specs-mini" id="product-specs-mini"></div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Benefits -->
        <section class="benefits">
            <div class="section-container">
                <span class="section-label">Por que elegir este piso?</span>
                <h2 class="section-title">Excelencia en cada detalle</h2>
                <div class="benefits-grid">
                    <div class="benefit-card">
                        <div class="benefit-icon">&#9670;</div>
                        <h3 class="benefit-title">Resistencia Superior</h3>
                        <p class="benefit-text">Durabilidad excepcional para areas de alto trafico. Resistente a rayones, manchas y humedad.</p>
                    </div>
                    <div class="benefit-card">
                        <div class="benefit-icon">&#10023;</div>
                        <h3 class="benefit-title">Diseno Unico</h3>
                        <p class="benefit-text">Multiples caras unicas crean pisos con variacion natural que evitan patrones repetitivos.</p>
                    </div>
                    <div class="benefit-card">
                        <div class="benefit-icon">&#9671;</div>
                        <h3 class="benefit-title">Garantia Premium</h3>
                        <p class="benefit-text">Respaldado por mas de 25 anos de experiencia Cesantoni con certificaciones internacionales.</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Specs -->
        <section class="specs" id="specs-section">
            <div class="section-container">
                <span class="section-label">Especificaciones Tecnicas</span>
                <h2 class="section-title">La ciencia detras de la belleza</h2>
                <div class="specs-grid" id="specs-grid"></div>
            </div>
        </section>

        <!-- Related Products -->
        <section class="related" id="related-section">
            <div class="section-container">
                <span class="section-label">Te puede interesar</span>
                <h2 class="section-title">Productos Relacionados</h2>
                <div class="related-grid" id="related-grid"></div>
            </div>
        </section>

        <!-- Store -->
        <section class="store" id="store-section">
            <div class="section-container">
                <div class="store-grid">
                    <div class="store-info">
                        <span class="section-label">Disponible en</span>
                        <h3 id="store-name">Tienda</h3>
                        <div class="store-detail">
                            <svg class="store-detail-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path>
                                <circle cx="12" cy="10" r="3"></circle>
                            </svg>
                            <div class="store-detail-text">
                                <strong>Direccion</strong>
                                <span id="store-address">-</span>
                            </div>
                        </div>
                        <div class="store-detail">
                            <svg class="store-detail-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"></path>
                            </svg>
                            <div class="store-detail-text">
                                <strong>Telefono</strong>
                                <span id="store-phone">-</span>
                            </div>
                        </div>
                        <div class="promo-banner" id="promo-banner" style="display: none;">
                            <span class="promo-banner-icon">üè∑Ô∏è</span>
                            <div class="promo-banner-text">
                                <strong id="promo-text">Promocion</strong>
                                <span id="promo-detail">Detalles</span>
                            </div>
                        </div>
                    </div>
                    <div class="store-map" id="store-map"></div>
                </div>
            </div>
        </section>

        <!-- Footer -->
        <footer>
            <a href="/" class="logo-link">
                <img src="/images/logo-cesantoni.png" alt="Cesantoni" class="footer-logo">
            </a>
            <p>¬© 2026 Cesantoni. Tradicion e innovacion desde 1998.</p>
        </footer>
    </main>

    <!-- Error State -->
    <div class="error-state" id="error-state" style="display: none;">
        <h1>Producto no encontrado</h1>
        <p>El producto que buscas no existe o fue removido.</p>
    </div>

    <!-- Chat IA -->
    <div class="chat-container" id="chat-container">
        <div class="chat-window" id="chat-window">
            <div class="chat-header">
                <span class="chat-header-title">Asistente Cesantoni</span>
                <button class="chat-close" onclick="toggleChat()">‚úï</button>
            </div>
            <div class="chat-messages" id="chat-messages">
                <div class="chat-msg bot">Hola, soy tu asistente Cesantoni. Preguntame sobre este producto.</div>
            </div>
            <div class="chat-suggestions" id="chat-suggestions">
                <button onclick="sendSuggestion(this)">¬øEs resistente?</button>
                <button onclick="sendSuggestion(this)">¬øDonde se puede usar?</button>
                <button onclick="sendSuggestion(this)">¬øComo se limpia?</button>
            </div>
            <div class="chat-input-row">
                <input type="text" id="chat-input" placeholder="Escribe tu pregunta..." onkeydown="if(event.key==='Enter')sendChat()">
                <button class="chat-send" onclick="sendChat()">‚û§</button>
            </div>
        </div>
        <button class="chat-fab" id="chat-fab" onclick="toggleChat()">
            <svg viewBox="0 0 24 24" fill="currentColor" width="28" height="28"><path d="M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 14H5.17L4 17.17V4h16v12z"/><path d="M7 9h2v2H7zm4 0h2v2h-2zm4 0h2v2h-2z"/></svg>
        </button>
    </div>

    <!-- WhatsApp CTA -->
    <a href="#" class="whatsapp-cta" id="whatsapp-cta" style="display: none;" target="_blank">
        <svg viewBox="0 0 24 24" fill="currentColor">
            <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"/>
        </svg>
        Cotizar por WhatsApp
    </a>

    <!-- Lightbox -->
    <div class="lightbox" id="lightbox">
        <button class="lightbox-close" onclick="closeLightbox()">&times;</button>
        <button class="lightbox-nav lightbox-prev" onclick="prevImage()">&#8249;</button>
        <img id="lightbox-img" src="" alt="">
        <button class="lightbox-nav lightbox-next" onclick="nextImage()">&#8250;</button>
    </div>

    <script>
        const API = '/api';
        const urlParams = new URLSearchParams(window.location.search);

        // Get params
        const params = {
            tienda: urlParams.get('tienda') || '',
            estado: urlParams.get('estado') || '',
            ciudad: urlParams.get('ciudad') || '',
            dir: urlParams.get('dir') || '',
            wa: urlParams.get('wa') || '',
            promo: urlParams.get('promo') || '',
            precio: urlParams.get('precio') || ''
        };

        // Get SKU from URL - try query param first, then path
        const pathParts = window.location.pathname.split('/');
        const pathSku = pathParts[pathParts.length - 1].replace('.html', '');
        const sku = urlParams.get('sku') || (pathSku !== 'landing' ? pathSku : null);

        let product = null;
        let store = null;
        let gallery = [];
        let currentImageIndex = 0;

        function generateTechnicalDescription(p) {
            const parts = [];

            // Tipo de producto
            if (p.type) {
                parts.push(`Fabricado en ${p.type.toLowerCase()}`);
            } else if (p.category === 'MADERA') {
                parts.push('Porcelanico tipo madera de alta definicion');
            } else if (p.category === 'MARMOL' || p.category === 'M√ÅRMOL') {
                parts.push('Porcelanico tipo marmol con vetas naturales');
            } else if (p.category === 'PIEDRA') {
                parts.push('Porcelanico tipo piedra con textura autentica');
            } else if (p.category === 'CEMENTO') {
                parts.push('Porcelanico tipo cemento de estilo industrial');
            } else {
                parts.push('Porcelanico de alta calidad');
            }

            // Formato
            if (p.format) {
                parts.push(`en formato ${p.format}`);
            }

            // Acabado
            if (p.finish) {
                parts.push(`con acabado ${p.finish.toLowerCase()}`);
            }

            // Resistencia PEI
            if (p.pei) {
                const peiDesc = {
                    '1': 'para trafico muy ligero',
                    '2': 'para trafico ligero residencial',
                    '3': 'para trafico moderado',
                    '4': 'para alto trafico comercial',
                    '5': 'para trafico intenso industrial'
                };
                parts.push(`. Resistencia PEI ${p.pei} ${peiDesc[p.pei] || ''}`);
            }

            // Uso
            if (p.usage || p.uses) {
                const uso = p.usage || p.uses;
                parts.push(`. Ideal para uso en ${uso.toLowerCase()}`);
            } else {
                parts.push('. Apto para interiores y exteriores');
            }

            // Pasta/Tipo base
            if (p.type && p.type.toLowerCase().includes('rectificado')) {
                parts.push('. Bordes rectificados para juntas minimas');
            }

            // Absorcion de agua
            if (p.water_absorption) {
                parts.push(`. Absorcion de agua ${p.water_absorption}`);
            }

            // Cierre
            parts.push('. Cumple con los mas altos estandares de calidad Cesantoni.');

            return parts.join(' ').replace(/\s+\./g, '.').replace(/\.\s*\./g, '.');
        }

        async function init() {
            if (!sku) {
                showError();
                return;
            }

            try {
                // Load product
                const res = await fetch(`${API}/landing/${sku}`);
                if (!res.ok) throw new Error('Product not found');
                product = await res.json();

                // Parse gallery
                try {
                    gallery = JSON.parse(product.gallery || '[]');
                } catch (e) { gallery = []; }

                // Find store
                if (params.tienda) {
                    const stores = await fetch(`${API}/stores`).then(r => r.json());
                    store = stores.find(s =>
                        s.slug === params.tienda ||
                        s.name.toLowerCase().includes(params.tienda.toLowerCase())
                    );
                }

                // Render page
                render();

                // Track scan
                trackScan();

            } catch (err) {
                console.error(err);
                showError();
            }
        }

        function render() {
            // Hide loading, show content
            document.getElementById('loading').classList.add('hide');
            document.getElementById('main-content').style.display = 'block';

            // Page title
            document.title = `${product.name} | Cesantoni Premium`;
            document.getElementById('page-title').textContent = `${product.name} | Cesantoni Premium`;

            // Hero
            if (product.video_url) {
                document.getElementById('hero-video').src = product.video_url;
            } else {
                document.getElementById('video-hero').style.background = `url('${product.image_url}') center/cover`;
                document.getElementById('hero-video').style.display = 'none';
            }

            document.getElementById('hero-tag').textContent = product.category || 'Piso Premium';
            document.getElementById('hero-title').textContent = product.name;
            document.getElementById('hero-subtitle').textContent = product.description || 'Descubre la elegancia y calidad superior de los pisos Cesantoni.';
            document.getElementById('header-badge').textContent = product.category || 'Coleccion Exclusiva';

            // Gallery
            if (gallery.length > 0) {
                const galleryGrid = document.getElementById('gallery-grid');
                galleryGrid.innerHTML = gallery.map((img, i) => `
                    <div class="gallery-item" onclick="openLightbox(${i})">
                        <img src="${img}" alt="${product.name}" loading="lazy">
                    </div>
                `).join('');
            } else {
                document.getElementById('gallery-section').classList.add('hidden');
            }

            // Product info
            document.getElementById('product-main-image').src = product.image_url;
            document.getElementById('product-main-image').alt = product.name;
            document.getElementById('product-type').textContent = product.category || 'Porcelanico Premium';
            document.getElementById('product-name').textContent = product.name;
            document.getElementById('product-format').textContent = product.format ? `${product.format} | ${product.finish || 'Acabado Premium'}` : 'Formato Premium';
            document.getElementById('product-description').textContent = generateTechnicalDescription(product);

            // Mini specs
            const miniSpecs = [];
            if (product.pei) miniSpecs.push({ value: `PEI ${product.pei}`, label: 'Resistencia' });
            if (product.mohs) miniSpecs.push({ value: `${product.mohs}`, label: 'Dureza Mohs' });
            if (product.water_absorption) miniSpecs.push({ value: product.water_absorption, label: 'Absorcion' });
            if (product.usage) miniSpecs.push({ value: product.usage, label: 'Uso' });
            if (miniSpecs.length < 4 && product.type) miniSpecs.push({ value: product.type, label: 'Tipo' });
            if (miniSpecs.length < 4) miniSpecs.push({ value: 'Int/Ext', label: 'Versatil' });

            document.getElementById('product-specs-mini').innerHTML = miniSpecs.slice(0, 4).map(s => `
                <div class="spec-mini">
                    <div class="spec-mini-value">${s.value}</div>
                    <div class="spec-mini-label">${s.label}</div>
                </div>
            `).join('');

            // Full specs - always show 8 specs with defaults
            const specs = [
                { value: product.format || '60 x 60 cm', label: 'Formato' },
                { value: product.pei ? `PEI ${product.pei}` : 'PEI 4', label: 'Resistencia' },
                { value: product.water_absorption || '< 0.5%', label: 'Absorcion' },
                { value: product.finish || 'MATE', label: 'Acabado' },
                { value: product.type || 'PORCELANICO', label: 'Tipo' },
                { value: product.usage || 'INT / EXT', label: 'Uso' },
                { value: product.mohs || '6-7', label: 'Dureza Mohs' },
                { value: 'Pasta Blanca', label: 'Calidad de Exportaci√≥n' }
            ];

            document.getElementById('specs-grid').innerHTML = specs.map(s => `
                <div class="spec-item">
                    <div class="spec-value">${s.value}</div>
                    <div class="spec-label">${s.label}</div>
                </div>
            `).join('');

            // Related products
            let relatedIds = [];
            try {
                relatedIds = JSON.parse(product.related_products || '[]');
            } catch (e) {}

            if (relatedIds.length > 0) {
                loadRelatedProducts(relatedIds);
            } else {
                document.getElementById('related-section').classList.add('hidden');
            }

            // Store
            if (store) {
                document.getElementById('store-name').textContent = store.name;
                document.getElementById('store-address').textContent = store.address || params.dir || '-';
                document.getElementById('store-phone').textContent = store.phone || params.wa || '-';

                if (store.lat && store.lng) {
                    document.getElementById('store-map').innerHTML = `
                        <iframe src="https://www.google.com/maps/embed/v1/place?key=AIzaSyBFw0Qbyq9zTFTd-tUY6dZWTgaQzuU17R8&q=${store.lat},${store.lng}&zoom=15" allowfullscreen></iframe>
                    `;
                }
            } else if (params.tienda) {
                document.getElementById('store-name').textContent = decodeURIComponent(params.tienda).replace(/-/g, ' ');
                document.getElementById('store-address').textContent = params.dir ? decodeURIComponent(params.dir) : '-';
                document.getElementById('store-phone').textContent = params.wa || '-';
            } else {
                document.getElementById('store-section').classList.add('hidden');
            }

            // Promo
            if (params.promo) {
                document.getElementById('promo-banner').style.display = 'flex';
                document.getElementById('promo-text').textContent = decodeURIComponent(params.promo);
                document.getElementById('promo-detail').textContent = params.precio ? `Precio especial: $${params.precio}` : 'Promocion por tiempo limitado';
            }

            // WhatsApp
            const waNumber = params.wa || (store && store.phone) || '';
            if (waNumber) {
                const waClean = waNumber.replace(/\D/g, '');
                const waMsg = encodeURIComponent(`Hola, vi el piso ${product.name} en su showroom y me interesa mas informacion`);
                document.getElementById('whatsapp-cta').href = `https://wa.me/${waClean}?text=${waMsg}`;
                document.getElementById('whatsapp-cta').style.display = 'flex';
            }
        }

        async function loadRelatedProducts(ids) {
            const grid = document.getElementById('related-grid');
            const products = await Promise.all(
                ids.slice(0, 4).map(id =>
                    fetch(`${API}/products/${id}`).then(r => r.ok ? r.json() : null).catch(() => null)
                )
            );

            const validProducts = products.filter(p => p);
            if (validProducts.length === 0) {
                document.getElementById('related-section').classList.add('hidden');
                return;
            }

            grid.innerHTML = validProducts.map(p => `
                <a href="/landing.html?sku=${p.slug || p.id}" class="related-item" style="text-decoration: none;">
                    <div class="related-item-image">
                        <img src="${p.image_url}" alt="${p.name}" loading="lazy">
                    </div>
                    <div class="related-item-info">
                        <div class="related-item-name">${p.name}</div>
                        <div class="related-item-category">${p.category || 'Premium'}</div>
                    </div>
                </a>
            `).join('');
        }

        function trackScan() {
            fetch(`${API}/track/scan`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    product_sku: product.sku,
                    store_id: store?.id || null,
                    session_id: Math.random().toString(36).substr(2, 9)
                })
            }).catch(() => {});
        }

        function showError() {
            document.getElementById('loading').classList.add('hide');
            document.getElementById('error-state').style.display = 'flex';
        }

        // Lightbox
        function openLightbox(index) {
            currentImageIndex = index;
            document.getElementById('lightbox-img').src = gallery[index];
            document.getElementById('lightbox').classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        function closeLightbox() {
            document.getElementById('lightbox').classList.remove('active');
            document.body.style.overflow = '';
        }

        function nextImage() {
            currentImageIndex = (currentImageIndex + 1) % gallery.length;
            document.getElementById('lightbox-img').src = gallery[currentImageIndex];
        }

        function prevImage() {
            currentImageIndex = (currentImageIndex - 1 + gallery.length) % gallery.length;
            document.getElementById('lightbox-img').src = gallery[currentImageIndex];
        }

        // Keyboard navigation
        document.addEventListener('keydown', (e) => {
            if (!document.getElementById('lightbox').classList.contains('active')) return;
            if (e.key === 'Escape') closeLightbox();
            if (e.key === 'ArrowRight') nextImage();
            if (e.key === 'ArrowLeft') prevImage();
        });

        // Header scroll
        window.addEventListener('scroll', () => {
            document.getElementById('header').classList.toggle('scrolled', window.scrollY > 100);
        });

        // Chat IA
        function toggleChat() {
            const win = document.getElementById('chat-window');
            win.classList.toggle('open');
        }

        function sendSuggestion(btn) {
            document.getElementById('chat-input').value = btn.textContent;
            document.getElementById('chat-suggestions').style.display = 'none';
            sendChat();
        }

        async function sendChat() {
            const input = document.getElementById('chat-input');
            const msg = input.value.trim();
            if (!msg) return;

            const messages = document.getElementById('chat-messages');

            // User message
            const userDiv = document.createElement('div');
            userDiv.className = 'chat-msg user';
            userDiv.textContent = msg;
            messages.appendChild(userDiv);
            input.value = '';

            // Typing indicator
            const typingDiv = document.createElement('div');
            typingDiv.className = 'chat-msg bot typing';
            typingDiv.textContent = 'Escribiendo...';
            messages.appendChild(typingDiv);
            messages.scrollTop = messages.scrollHeight;

            try {
                const res = await fetch('/api/chat', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        message: msg,
                        product: product ? {
                            name: product.name,
                            category: product.category,
                            type: product.type,
                            format: product.format,
                            finish: product.finish,
                            price: product.base_price,
                            description: product.description,
                            pei: product.pei,
                            uses: product.usage || product.uses
                        } : null,
                        store: store ? {
                            name: store.name,
                            address: store.address,
                            city: store.city,
                            state: store.state,
                            phone: store.phone || store.whatsapp
                        } : null
                    })
                });
                const data = await res.json();
                typingDiv.remove();

                const botDiv = document.createElement('div');
                botDiv.className = 'chat-msg bot';
                botDiv.textContent = data.reply || 'Lo siento, no pude responder. Intenta de nuevo.';
                messages.appendChild(botDiv);
            } catch (err) {
                typingDiv.remove();
                const errDiv = document.createElement('div');
                errDiv.className = 'chat-msg bot';
                errDiv.textContent = 'Error de conexion. Intenta de nuevo.';
                messages.appendChild(errDiv);
            }
            messages.scrollTop = messages.scrollHeight;
        }

        // Init
        init();
    </script>
</body>
</html>
